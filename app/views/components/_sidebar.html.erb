<%# locals: (id: nil, state: :collapsed, collapsible: :offcanvas, variant: :inset, side: :left, css_classes: "", **html_options) %>
<% stable_id = id || "sidebar-#{side}"
  
  merged_data = (html_options.delete(:data) || {}).merge(
    sidebar_part: :root,
    sidebar_target: "sidebar",
    state: state,
    variant: variant,
    collapsible: collapsible,
    side: side
  ) %>

<aside
  id="<%= stable_id %>"
  class="group peer sidebar-loading <%= css_classes %>"
  <%= tag.attributes(data: merged_data, **html_options) %>
>
  <%# Sidebar gap (creates space for sidebar on desktop) %>
  <div id="<%= stable_id %>-gap" data-sidebar-part="gap"></div>

  <%# Mobile backdrop overlay %>
  <div
    id="<%= stable_id %>-overlay"
    data-sidebar-part="backdrop"
    data-sidebar-target="backdrop"
    data-action="click->sidebar#backdropClick"
  ></div>

  <%# Sidebar container (fixed positioned) %>
  <div
    id="<%= stable_id %>-container"
    data-sidebar-part="container"
    data-sidebar-target="container"
  >
    <%# Inner sidebar content wrapper %>
    <div id="<%= stable_id %>-inner" data-sidebar-part="inner">
      <%= yield %>
    </div>
  </div>
</aside>
