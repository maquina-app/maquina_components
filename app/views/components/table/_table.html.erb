<%# locals: (columns:, rows:, empty_state_partial: nil, row_partial: nil, empty_state_locals: {}, table_class: "", container_class: "", id: nil) -%>

<div
  class="<%= class_names("bg-card shadow-sm rounded-lg overflow-hidden border border-border", container_class) %>"
  <%= "id=\"#{id}\"" if id.present? %>
>
  <div class="overflow-x-auto">
    <table
      class="<%= class_names("min-w-full divide-y divide-border", table_class) %>"
    >
      <thead class="bg-muted/50">
        <tr>
          <% columns.each do |column| %>
            <% if column[:sortable] %>
              <th scope="col" class="px-6 py-3 text-left">
                <%= link_to column[:path] || "#",
                    class: class_names("group inline-flex items-center gap-1 text-xs font-medium text-muted-foreground uppercase tracking-wider hover:text-foreground transition-colors"),
                    data: column[:data] || {} do %>
                  <%= column[:label] %>
                  <span
                    class="<%= class_names("flex-none rounded", params[:sort] == column[:key].to_s ? "text-foreground" : "text-muted-foreground/60 group-hover:text-muted-foreground") %>"
                  >
                    <% if params[:sort] == column[:key].to_s %>
                      <% if params[:direction] == "asc" %>
                        <svg class="h-4 w-4" fill="currentColor" viewBox="0 0 20 20">
                          <path
                            fill-rule="evenodd"
                            d="M14.707 12.707a1 1 0 01-1.414 0L10 9.414l-3.293 3.293a1 1 0 01-1.414-1.414l4-4a1 1 0 011.414 0l4 4a1 1 0 010 1.414z"
                            clip-rule="evenodd"
                          />
                        </svg>
                      <% else %>
                        <svg class="h-4 w-4" fill="currentColor" viewBox="0 0 20 20">
                          <path
                            fill-rule="evenodd"
                            d="M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z"
                            clip-rule="evenodd"
                          />
                        </svg>
                      <% end %>
                    <% else %>
                      <svg class="h-4 w-4" fill="currentColor" viewBox="0 0 20 20">
                        <path
                          fill-rule="evenodd"
                          d="M10 3a1 1 0 01.707.293l3 3a1 1 0 01-1.414 1.414L10 5.414 7.707 7.707a1 1 0 01-1.414-1.414l3-3A1 1 0 0110 3zm-3.707 9.293a1 1 0 011.414 0L10 14.586l2.293-2.293a1 1 0 011.414 1.414l-3 3a1 1 0 01-1.414 0l-3-3a1 1 0 010-1.414z"
                          clip-rule="evenodd"
                        />
                      </svg>
                    <% end %>
                  </span>
                <% end %>
              </th>
            <% else %>
              <th
                scope="col"
                class="<%= column[:class] || "px-6 py-3 text-left text-xs font-medium text-muted-foreground uppercase tracking-wider" %>"
              >
                <%= column[:label] %>
              </th>
            <% end %>
          <% end %>
        </tr>
      </thead>
      <tbody class="bg-card divide-y divide-border">
        <% if rows.any? %>
          <% rows.each do |row| %>
            <% if row_partial.present? %>
              <%= render row_partial, item: row, columns: columns %>
            <% else %>
              <tr class="hover:bg-muted/50 transition-colors">
                <% columns.each do |column| %>
                  <td class="px-6 py-4 whitespace-nowrap text-sm">
                    <% if column[:render].present? %>
                      <%= column[:render].call(row) %>
                    <% else %>
                      <%= row.public_send(column[:key]) %>
                    <% end %>
                  </td>
                <% end %>
              </tr>
            <% end %>
          <% end %>
        <% else %>
          <% if empty_state_partial.present? %>
            <%= render empty_state_partial, empty_state_locals %>
          <% else %>
            <tr>
              <td colspan="<%= columns.size %>" class="px-6 py-12 text-center">
                <div class="text-muted-foreground">
                  <svg
                    class="mx-auto h-12 w-12 text-muted-foreground/60"
                    fill="none"
                    stroke="currentColor"
                    viewBox="0 0 24 24"
                  >
                    <path
                      stroke-linecap="round"
                      stroke-linejoin="round"
                      stroke-width="2"
                      d="M9 13h6m-3-3v6m-9 1V7a2 2 0 012-2h6l2 2h6a2 2 0 012 2v8a2 2 0 01-2 2H5a2 2 0 01-2-2z"
                    />
                  </svg>
                  <h3 class="mt-2 text-sm font-medium text-foreground">No data</h3>
                  <p class="mt-1 text-sm text-muted-foreground">No records found.</p>
                </div>
              </td>
            </tr>
          <% end %>
        <% end %>
      </tbody>
    </table>
  </div>
</div>
